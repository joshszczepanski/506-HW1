---
title: "HW-1Quarto"
format: html
editor: visual
---


```{r}
# Install necessary packages

#install.packages("tidyverse")    # Includes dplyr, ggplot2, readr, etc.
#install.packages("readr")        # For reading .csv and .txt files
#install.packages("dplyr")        # For data manipulation
#install.packages("ggplot2")      # For plotting (if needed)
#install.packages("stringr")      # For string manipulation
#install.packages("purrr")        # For functional programming
#install.packages("tibble")       # Enhanced data frames
#install.packages("broom")        # For tidying statistical output
#install.packages("data.table")   # Efficient data import/manipulation
#install.packages("janitor")      # For cleaning variable names
#install.packages("psych")        # For correlation matrices and descriptives


#1 a)

col_names <- c(
  "sex", "length", "diameter", "height",
  "whole_weight", "shucked_weight",
  "viscera_weight", "shell_weight",
  "rings")


read.table("/Users/joshszczepanski/Downloads/abalone/abalone.data")
abalone = read.table("/Users/joshszczepanski/Downloads/abalone/abalone.data",
                      sep = ",",
                      header = FALSE,
                      col.names = col_names)

#1 b)
table(abalone$sex)

# The table shows F: 1307, I: 1342, M: 1528


#1 c1)
allweights_and_rings_column <- abalone[ ,c("whole_weight", "shucked_weight",
  "viscera_weight", "shell_weight", "rings")]
                      

correlations <- sapply(allweights_and_rings_column[1:4], function(x) cor(x, allweights_and_rings_column$rings))

correlations

max_cor_weight <- names(which.max(correlations))
max_cor_value <- max(correlations)

cat("The weight with the highest correlation is:", max_cor_weight, "it has a correlation of", round(max_cor_value, 4), "\n")

# The weight with the highest correlation is: shell_weight it has a correlation of 0.6276 

library(dplyr)

abalone %>%
  group_by(sex) %>%
  summarise(correlation = cor(shell_weight, rings)) %>%
  arrange(desc(correlation))


```

